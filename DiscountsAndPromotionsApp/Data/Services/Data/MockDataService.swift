import Foundation
import Combine

// swiftlint:disable type_body_length
// swiftlint:disable function_body_length

final class MockDataService: DataServiceProtocol {
    private (set) var actualGoodsList = CurrentValueSubject<[Product], Never>([])
    private (set) var actualCategoryList = CurrentValueSubject<[Category], Never>([])
    private (set) var actualStoreList = CurrentValueSubject<[Store], Never>([])
    private (set) var promotionList = CurrentValueSubject<[Product], Never>([])

    private var goods: [Product] = [] {
        didSet {
            actualGoodsList.send(goods)
        }
    }

    private var categories: [Category] = [] {
        didSet {
            actualCategoryList.send(categories)
        }
    }

    private var stores: [Store] = [] {
        didSet {
            actualStoreList.send(stores)
        }
    }

    private var promotion: [Product] = [] {
        didSet {
            promotionList.send(promotion)
        }
    }

    func loadData() {
        // Заменить в дальнейшем на походы в сеть
        self.categories = generateCategories()
        self.goods = generateGoods()
        self.stores = generateStores()
        self.promotion = generatePromotions()
    }

    private func generateCategories() -> [Category] {
        return [Category(id: 0, name: "Продукты", image: "ProductsCategoryIcon"),
                Category(id: 1, name: "Одежда и обувь", image: "ClothesAndShoesCategoryIcon"),
                Category(id: 2, name: "Косметика и гигиена", image: "CosmeticsCategoryIcon"),
                Category(id: 3, name: "Для детей", image: "ForKindsCategoryIcon"),
                Category(id: 4, name: "Дом и сад", image: "HomeAndGardenCategoryIcon"),
                Category(id: 5, name: "Зоотовары", image: "PetSuppliesCategoryIcon"),
                Category(id: 6, name: "Праздник", image: "HolidayCategoryIcon"),
                Category(id: 7, name: "Авто", image: "AutoCategoryIcon")]
    }

    private func generateGoods() -> [Product] {
        // Убедимся, что у нас есть категории для использования
        guard let categoryProducts = categories.first(where: { $0.name == "Продукты" }),

                let categoryClothesAndShoes = categories.first(where: { $0.name == "Одежда и обувь" }),

                let categoryCosmetics = categories.first(where: { $0.name == "Косметика и гигиена" }),

                let categoryForKids = categories.first(where: { $0.name == "Для детей" }),

                let categoryHomeAndGarden = categories.first(where: { $0.name == "Дом и сад" }),

                let categoryPetSupplies = categories.first(where: { $0.name == "Зоотовары" }),

                let categoryHoliday = categories.first(where: { $0.name == "Праздник" }),

                let categoryAuto = categories.first(where: { $0.name == "Авто" }) else {
            return []
        }

        return [Product(barcode: "4607084351378",
                        name: "Пирожное Choco Pie Orion",
                        description: "30 г 6 штук",
                        category: categoryProducts,
                        image: ProductImage(mainImage: "chokoPie",
                                            additionalPhoto: nil),
                        rating: 4.5,
                        offers: [Offer(price: 66,
                                       initialPrice: 999,
                                       discount: nil,
                                       store: Store(name: "Пятерочка",
                                                    image: nil,
                                                    location: StoreLocation(region: "Москва",
                                                                            city: "Москва",
                                                                            street: "Ленина",
                                                                            building: "15",
                                                                            postalIndex: 117899),
                                                    chainStore: nil)),
                                 Offer(price: 120,
                                       initialPrice: 999,
                                       discount: nil,
                                       store: Store(name: "Дикси",
                                                    image: nil,
                                                    location: StoreLocation(region: "Москва",
                                                                            city: "Москва",
                                                                            street: "Герасимова",
                                                                            building: "10",
                                                                            postalIndex: 117099),
                                                    chainStore: nil))]),
                Product(barcode: "4601662000016",
                        name: "Молоко Parmalat 3,5%",
                        description: "ультрапастеризованное",
                        category: categoryProducts,
                        image: ProductImage(mainImage: "parmalatMoloko",
                                            additionalPhoto: nil),
                        rating: nil,
                        offers: [Offer(price: 99,
                                       initialPrice: 999,
                                       discount: nil,
                                       store: Store(name: "Пятерочка",
                                                    image: nil,
                                                    location: StoreLocation(region: "Москва",
                                                                            city: "Москва",
                                                                            street: "Ленина",
                                                                            building: "15",
                                                                            postalIndex: 117899),
                                                    chainStore: nil)),
                                 Offer(price: 118,
                                       initialPrice: 999,
                                       discount: nil,
                                       store: Store(name: "Дикси",
                                                    image: nil,
                                                    location: StoreLocation(region: "Москва",
                                                                            city: "Москва",
                                                                            street: "Герасимова",
                                                                            building: "10",
                                                                            postalIndex: 117099),
                                                    chainStore: nil))]),
                Product(barcode: "4015100335965",
                        name: "SYOSS Men Power",
                        description: "Шампунь для нормальный волос 450 мл 1 шт",
                        category: categoryCosmetics,
                        image: ProductImage(mainImage: "syossShampoo",
                                            additionalPhoto: nil),
                        rating: nil,
                        offers: [Offer(price: 256,
                                       initialPrice: 999,
                                       discount: nil,
                                       store: Store(name: "Пятерочка",
                                                    image: nil,
                                                    location: StoreLocation(region: "Москва",
                                                                            city: "Москва",
                                                                            street: "Ленина",
                                                                            building: "15",
                                                                            postalIndex: 117899),
                                                    chainStore: nil)),
                                 Offer(price: 390,
                                       initialPrice: 999,
                                       discount: nil,
                                       store: Store(name: "Дикси",
                                                    image: nil,
                                                    location: StoreLocation(region: "Москва",
                                                                            city: "Москва",
                                                                            street: "Герасимова",
                                                                            building: "10",
                                                                            postalIndex: 117099),
                                                    chainStore: nil))]),
                Product(barcode: "4600338000305",
                        name: "ФрутоНяНя Нектар",
                        description: "Из бананов с мякотью 6 мес. тетра пак 200 мл",
                        category: categoryForKids,
                        image: ProductImage(mainImage: "frutoNyana",
                                            additionalPhoto: nil),
                        rating: nil,
                        offers: [Offer(price: 27,
                                       initialPrice: 999,
                                       discount: nil,
                                       store: Store(name: "Пятерочка",
                                                    image: nil,
                                                    location: StoreLocation(region: "Москва",
                                                                            city: "Москва",
                                                                            street: "Ленина",
                                                                            building: "15",
                                                                            postalIndex: 117899),
                                                    chainStore: nil)),
                                 Offer(price: 39,
                                       initialPrice: 999,
                                       discount: nil,
                                       store: Store(name: "Дикси",
                                                    image: nil,
                                                    location: StoreLocation(region: "Москва",
                                                                            city: "Москва",
                                                                            street: "Герасимова",
                                                                            building: "10",
                                                                            postalIndex: 117099),
                                                    chainStore: nil))]),
                Product(barcode: "",
                        name: "Авто Шампунь",
                        description: "",
                        category: categoryAuto,
                        image: ProductImage(mainImage: "avtoShampooMock",
                                            additionalPhoto: nil),
                        rating: nil,
                        offers: [Offer(price: 150,
                                       initialPrice: 999,
                                       discount: nil,
                                       store: Store(name: "Пятерочка",
                                                    image: nil,
                                                    location: StoreLocation(region: "Москва",
                                                                            city: "Москва",
                                                                            street: "Ленина",
                                                                            building: "15",
                                                                            postalIndex: 117899),
                                                    chainStore: nil)),
                                 Offer(price: 290,
                                       initialPrice: 999,
                                       discount: nil,
                                       store: Store(name: "Дикси",
                                                    image: nil,
                                                    location: StoreLocation(region: "Москва",
                                                                            city: "Москва",
                                                                            street: "Герасимова",
                                                                            building: "10",
                                                                            postalIndex: 117099),
                                                    chainStore: nil))]),
                Product(barcode: "",
                        name: "Шарики надувные в ассортименте",
                        description: "",
                        category: categoryHoliday,
                        image: ProductImage(mainImage: "sharikiMock",
                                            additionalPhoto: nil),
                        rating: nil,
                        offers: [Offer(price: 150,
                                       initialPrice: 999,
                                       discount: nil,
                                       store: Store(name: "Пятерочка",
                                                    image: nil,
                                                    location: StoreLocation(region: "Москва",
                                                                            city: "Москва",
                                                                            street: "Ленина",
                                                                            building: "15",
                                                                            postalIndex: 117899),
                                                    chainStore: nil)),
                                 Offer(price: 290,
                                       initialPrice: 999,
                                       discount: nil,
                                       store: Store(name: "Дикси",
                                                    image: nil,
                                                    location: StoreLocation(region: "Москва",
                                                                            city: "Москва",
                                                                            street: "Герасимова",
                                                                            building: "10",
                                                                            postalIndex: 117099),
                                                    chainStore: nil))]),
                Product(barcode: "",
                        name: "Ошейник синий",
                        description: "",
                        category: categoryPetSupplies,
                        image: ProductImage(mainImage: "osheinikMock",
                                            additionalPhoto: nil),
                        rating: nil,
                        offers: [Offer(price: 150,
                                       initialPrice: 999,
                                       discount: nil,
                                       store: Store(name: "Пятерочка",
                                                    image: nil,
                                                    location: StoreLocation(region: "Москва",
                                                                            city: "Москва",
                                                                            street: "Ленина",
                                                                            building: "15",
                                                                            postalIndex: 117899),
                                                    chainStore: nil)),
                                 Offer(price: 290,
                                       initialPrice: 999,
                                       discount: nil,
                                       store: Store(name: "Дикси",
                                                    image: nil,
                                                    location: StoreLocation(region: "Москва",
                                                                            city: "Москва",
                                                                            street: "Герасимова",
                                                                            building: "10",
                                                                            postalIndex: 117099),
                                                    chainStore: nil))]),
                Product(barcode: "",
                        name: "Тачка садовая",
                        description: "",
                        category: categoryHomeAndGarden,
                        image: ProductImage(mainImage: "tachkaSadoviaMock",
                                            additionalPhoto: nil),
                        rating: nil,
                        offers: [Offer(price: 150,
                                       initialPrice: 999,
                                       discount: nil,
                                       store: Store(name: "Пятерочка",
                                                    image: nil,
                                                    location: StoreLocation(region: "Москва",
                                                                            city: "Москва",
                                                                            street: "Ленина",
                                                                            building: "15",
                                                                            postalIndex: 117899),
                                                    chainStore: nil)),
                                 Offer(price: 290,
                                       initialPrice: 999,
                                       discount: nil,
                                       store: Store(name: "Дикси",
                                                    image: nil,
                                                    location: StoreLocation(region: "Москва",
                                                                            city: "Москва",
                                                                            street: "Герасимова",
                                                                            building: "10",
                                                                            postalIndex: 117099),
                                                    chainStore: nil))]),
                Product(barcode: "",
                        name: "Подгузники Haggies",
                        description: "",
                        category: categoryForKids,
                        image: ProductImage(mainImage: "haggiesMock",
                                            additionalPhoto: nil),
                        rating: nil,
                        offers: [Offer(price: 150,
                                       initialPrice: 999,
                                       discount: nil,
                                       store: Store(name: "Пятерочка",
                                                    image: nil,
                                                    location: StoreLocation(region: "Москва",
                                                                            city: "Москва",
                                                                            street: "Ленина",
                                                                            building: "15",
                                                                            postalIndex: 117899),
                                                    chainStore: nil)),
                                 Offer(price: 290,
                                       initialPrice: 999,
                                       discount: nil,
                                       store: Store(name: "Дикси",
                                                    image: nil,
                                                    location: StoreLocation(region: "Москва",
                                                                            city: "Москва",
                                                                            street: "Герасимова",
                                                                            building: "10",
                                                                            postalIndex: 117099),
                                                    chainStore: nil))]),
                Product(barcode: "",
                        name: "Тушь черная",
                        description: "",
                        category: categoryCosmetics,
                        image: ProductImage(mainImage: "tyshMock",
                                            additionalPhoto: nil),
                        rating: nil,
                        offers: [Offer(price: 150,
                                       initialPrice: 999,
                                       discount: nil,
                                       store: Store(name: "Пятерочка",
                                                    image: nil,
                                                    location: StoreLocation(region: "Москва",
                                                                            city: "Москва",
                                                                            street: "Ленина",
                                                                            building: "15",
                                                                            postalIndex: 117899),
                                                    chainStore: nil)),
                                 Offer(price: 290,
                                       initialPrice: 999,
                                       discount: nil,
                                       store: Store(name: "Дикси",
                                                    image: nil,
                                                    location: StoreLocation(region: "Москва",
                                                                            city: "Москва",
                                                                            street: "Герасимова",
                                                                            building: "10",
                                                                            postalIndex: 117099),
                                                    chainStore: nil))]),
                Product(barcode: "",
                        name: "Джинсы синие",
                        description: "",
                        category: categoryClothesAndShoes,
                        image: ProductImage(mainImage: "djinsiMock",
                                            additionalPhoto: nil),
                        rating: nil,
                        offers: [Offer(price: 150,
                                       initialPrice: 999,
                                       discount: nil,
                                       store: Store(name: "Пятерочка",
                                                    image: nil,
                                                    location: StoreLocation(region: "Москва",
                                                                            city: "Москва",
                                                                            street: "Ленина",
                                                                            building: "15",
                                                                            postalIndex: 117899),
                                                    chainStore: nil)),
                                 Offer(price: 290,
                                       initialPrice: 999,
                                       discount: nil,
                                       store: Store(name: "Дикси",
                                                    image: nil,
                                                    location: StoreLocation(region: "Москва",
                                                                            city: "Москва",
                                                                            street: "Герасимова",
                                                                            building: "10",
                                                                            postalIndex: 117099),
                                                    chainStore: nil))]),
                Product(barcode: "",
                        name: "Томаты сливовидные",
                        description: "1 кг",
                        category: categoryProducts,
                        image: ProductImage(mainImage: "tomatoMock",
                                            additionalPhoto: nil),
                        rating: 3,
                        offers: [Offer(price: 150,
                                       initialPrice: 999,
                                       discount: nil,
                                       store: Store(name: "Пятерочка",
                                                    image: nil,
                                                    location: StoreLocation(region: "Москва",
                                                                            city: "Москва",
                                                                            street: "Ленина",
                                                                            building: "15",
                                                                            postalIndex: 117899),
                                                    chainStore: nil)),
                                 Offer(price: 290,
                                       initialPrice: 999,
                                       discount: nil,
                                       store: Store(name: "Дикси",
                                                    image: nil,
                                                    location: StoreLocation(region: "Москва",
                                                                            city: "Москва",
                                                                            street: "Герасимова",
                                                                            building: "10",
                                                                            postalIndex: 117099),
                                                    chainStore: nil))]),
                Product(barcode: "",
                        name: "Салат Айсберг",
                        description: "1 шт.",
                        category: categoryProducts,
                        image: ProductImage(mainImage: "aisbergSalatMock",
                                            additionalPhoto: nil),
                        rating: nil,
                        offers: [Offer(price: 90,
                                       initialPrice: 999,
                                       discount: nil,
                                       store: Store(name: "Пятерочка",
                                                    image: nil,
                                                    location: StoreLocation(region: "Москва",
                                                                            city: "Москва",
                                                                            street: "Ленина",
                                                                            building: "15",
                                                                            postalIndex: 117899),
                                                    chainStore: nil)),
                                 Offer(price: 150,
                                       initialPrice: 999,
                                       discount: nil,
                                       store: Store(name: "Дикси",
                                                    image: nil,
                                                    location: StoreLocation(region: "Москва",
                                                                            city: "Москва",
                                                                            street: "Герасимова",
                                                                            building: "10",
                                                                            postalIndex: 117099),
                                                    chainStore: nil))]),
                Product(barcode: "12345678",
                        name: "Тыква Баттернат",
                        description: "3 кг",
                        category: categoryProducts,
                        image: ProductImage(mainImage: "tikvaMock",
                                            additionalPhoto: nil),
                        rating: nil,
                        offers: [Offer(price: 40,
                                       initialPrice: 999,
                                       discount: nil,
                                       store: Store(name: "Пятерочка",
                                                    image: nil,
                                                    location: StoreLocation(region: "Москва",
                                                                            city: "Москва",
                                                                            street: "Ленина",
                                                                            building: "15",
                                                                            postalIndex: 117899),
                                                    chainStore: nil)),
                                 Offer(price: 100,
                                       initialPrice: 999,
                                       discount: nil,
                                       store: Store(name: "Дикси",
                                                    image: nil,
                                                    location: StoreLocation(region: "Москва",
                                                                            city: "Москва",
                                                                            street: "Герасимова",
                                                                            building: "10",
                                                                            postalIndex: 117099),
                                                    chainStore: nil))]),
                Product(barcode: "",
                        name: "Капуста Брокколи",
                        description: "1 шт.",
                        category: categoryProducts,
                        image: ProductImage(mainImage: "brokoliMock",
                                            additionalPhoto: nil),
                        rating: nil,
                        offers: [Offer(price: 300,
                                       initialPrice: 999,
                                       discount: nil,
                                       store: Store(name: "Пятерочка",
                                                    image: nil,
                                                    location: StoreLocation(region: "Москва",
                                                                            city: "Москва",
                                                                            street: "Ленина",
                                                                            building: "15",
                                                                            postalIndex: 117899),
                                                    chainStore: nil)),
                                 Offer(price: 400,
                                       initialPrice: 999,
                                       discount: nil,
                                       store: Store(name: "Дикси",
                                                    image: nil,
                                                    location: StoreLocation(region: "Москва",
                                                                            city: "Москва",
                                                                            street: "Герасимова",
                                                                            building: "10",
                                                                            postalIndex: 117099),
                                                    chainStore: nil))]),
                Product(barcode: "",
                        name: "Груша конференция",
                        description: "1 кг",
                        category: categoryProducts,
                        image: ProductImage(mainImage: "grushaMock",
                                            additionalPhoto: nil),
                        rating: nil,
                        offers: [Offer(price: 220,
                                       initialPrice: 999,
                                       discount: nil,
                                       store: Store(name: "Пятерочка",
                                                    image: nil,
                                                    location: StoreLocation(region: "Москва",
                                                                            city: "Москва",
                                                                            street: "Ленина",
                                                                            building: "15",
                                                                            postalIndex: 117899),
                                                    chainStore: nil)),
                                 Offer(price: 280,
                                       initialPrice: 999,
                                       discount: nil,
                                       store: Store(name: "Дикси",
                                                    image: nil,
                                                    location: StoreLocation(region: "Москва",
                                                                            city: "Москва",
                                                                            street: "Герасимова",
                                                                            building: "10",
                                                                            postalIndex: 117099),
                                                    chainStore: nil))]),
                Product(barcode: "",
                        name: "Апельсины",
                        description: "1 кг",
                        category: categoryProducts,
                        image: ProductImage(mainImage: "apelsinMock", additionalPhoto: nil),
                        rating: nil,
                        offers: [Offer(price: 120,
                                       initialPrice: 999,
                                       discount: nil,
                                       store: Store(name: "Пятерочка",
                                                    image: nil,
                                                    location: StoreLocation(region: "Москва",
                                                                            city: "Москва",
                                                                            street: "Ленина",
                                                                            building: "15",
                                                                            postalIndex: 117899),
                                                    chainStore: nil)),
                                 Offer(price: 200,
                                       initialPrice: 999,
                                       discount: nil,
                                       store: Store(name: "Дикси",
                                                    image: nil,
                                                    location: StoreLocation(region: "Москва",
                                                                            city: "Москва",
                                                                            street: "Герасимова",
                                                                            building: "10",
                                                                            postalIndex: 117099),
                                                    chainStore: nil))]),
                Product(barcode: "",
                        name: "Картофель белый мытый",
                        description: "1 кг",
                        category: categoryProducts,
                        image: ProductImage(mainImage: "kartofelMock",
                                            additionalPhoto: nil),
                        rating: nil,
                        offers: [Offer(price: 40,
                                       initialPrice: 999,
                                       discount: nil,
                                       store: Store(name: "Пятерочка",
                                                    image: nil,
                                                    location: StoreLocation(region: "Москва",
                                                                            city: "Москва",
                                                                            street: "Ленина",
                                                                            building: "15",
                                                                            postalIndex: 117899),
                                                    chainStore: nil)),
                                 Offer(price: 100,
                                       initialPrice: 999,
                                       discount: nil,
                                       store: Store(name: "Дикси",
                                                    image: nil,
                                                    location: StoreLocation(region: "Москва",
                                                                            city: "Москва",
                                                                            street: "Герасимова",
                                                                            building: "10",
                                                                            postalIndex: 117099),
                                                    chainStore: nil))]),
                Product(barcode: "",
                        name: "Огурцы гладкие среднеплодные",
                        description: "1 кг",
                        category: categoryProducts,
                        image: ProductImage(mainImage: "ogyrciMock",
                                            additionalPhoto: nil),
                        rating: nil,
                        offers: [Offer(price: 99.99,
                                       initialPrice: 999,
                                       discount: nil,
                                       store: Store(name: "Пятерочка",
                                                    image: nil,
                                                    location: StoreLocation(region: "Москва",
                                                                            city: "Москва",
                                                                            street: "Ленина",
                                                                            building: "15",
                                                                            postalIndex: 117899),
                                                    chainStore: nil)),
                                 Offer(price: 200.20,
                                       initialPrice: 999,
                                       discount: nil,
                                       store: Store(name: "Дикси",
                                                    image: nil,
                                                    location: StoreLocation(region: "Москва",
                                                                            city: "Москва",
                                                                            street: "Герасимова",
                                                                            building: "10",
                                                                            postalIndex: 117099),
                                                    chainStore: nil))])]
    }

    func generateStores() -> [Store] {
        return [ Store(name: "Ашан",
                       image: StoreImage.init(mainImage: "Ashan", logoImage: "peterochka"),
                       location: StoreLocation(region: "Москва",
                                               city: "Москва",
                                               street: "Герасимова",
                                               building: "10",
                                               postalIndex: 117099),
                       chainStore: nil),
                 Store(name: "Торговая сеть Апекс",
                       image: StoreImage.init(mainImage: "Apeks", logoImage: "peterochka"),
                       location: StoreLocation(region: "Москва",
                                               city: "Москва",
                                               street: "Ленина",
                                               building: "15",
                                               postalIndex: 117899),
                       chainStore: nil),

                 Store(name: "М.видео",
                       image: StoreImage.init(mainImage: "MVideo", logoImage: "peterochka"),
                       location: StoreLocation(region: "Москва",
                                               city: "Москва",
                                               street: "Герасимова",
                                               building: "10",
                                               postalIndex: 117099),
                       chainStore: nil),

                 Store(name: "О'КЕЙ",
                       image: StoreImage.init(mainImage: "Okei", logoImage: "okeiLogo"),
                       location: StoreLocation(region: "Москва",
                                               city: "Москва",
                                               street: "Ленина",
                                               building: "15",
                                               postalIndex: 117899),
                       chainStore: nil),

                 Store(name: "Перекресток",
                       image: StoreImage.init(mainImage: "Perekrestok", logoImage: "perekrestokLogo"),
                       location: StoreLocation(region: "Москва",
                                               city: "Москва",
                                               street: "Герасимова",
                                               building: "10",
                                               postalIndex: 117099),
                       chainStore: nil),

                 Store(name: "Дикси",
                       image: StoreImage.init(mainImage: "Diksi", logoImage: "diksiLogo"),
                       location: StoreLocation(region: "Москва",
                                               city: "Москва",
                                               street: "Ленина",
                                               building: "15",
                                               postalIndex: 117899),
                       chainStore: nil)
        ]
    }

    private func generatePromotions() -> [Product] {
        return Array(goods.prefix(6))
    }
}
// swiftlint:enable type_body_length
// swiftlint:enable function_body_length
